#include <iostream>
#include <conio2.h>
#include<ctime>
#include <Windows.h> 

using namespace std;

int main(int argc, char *argv[]) {
	
	double t1,t2;
	double tempo=0.0;
	double delay=0.1;
	int monedas=0;
	int i=0;
	
	int n1=0;
	int n2=0;
	int n3=0;
	
	bool play=true;
	bool lose=false;
	bool flag=true;
	char tecla;
	int contador=0;
	
	cout<<"***********************************************"<<endl;
	cout<<"*       P       |        I        |     E     *"<<endl;
	cout<<"* Tirar palanca | Insertar moneda | Retirarse *"<<endl;
	cout<<"*  El juego permite ingresar hasta 9 monedas  *"<<endl;
	cout<<"*                                             *"<<endl;
	
	string linea1="*                   \\|||/                     *";
	string linea2="*                   (   )                     *";
	string linea3="*                    \\ /                      *";
	string linea4="*          .----oo0--(_)---------.            *";
	string linea5="*          | Coins ";
	string linea5b="             |            *";
	string linea6="*          |                     |            *";
	string linea7="*          |    .-----------.    |            *";
	string linea8="*          |    | ";
	string linea_aux=" | ";
	string linea8b="   |            *";	
	string linea9="*          |    .-----------.    |            *";	
	string linea10="*          |                     |            *";					
	string linea11="*          |                     |            *";
	string linea12="*          .---------------oo0---.            *";
	string linea13="*                  |  |  |                    *";
	string linea14="*                  |  |  |                    *"; 
	string linea15="*                  |__|__|                    *";
	string linea16="*                ___|| ||___                  *";
	string linea17="*               (____] [____)                 *";
	string linea18="***********************************************";
	
	while (play){
		
		gotoxy(1,6);
		
		cout<<linea1<<endl;
		cout<<linea2<<endl;	
		cout<<linea3<<endl;
		cout<<linea4<<endl;		
		cout<<linea5<<monedas<<linea5b<<endl;
		cout<<linea6<<endl;
		cout<<linea7<<endl;
		cout<<linea8<<n1<<linea_aux<<n2<<linea_aux<<n3<<linea_aux<<linea8b<<endl;
		cout<<linea9<<endl;
		cout<<linea10<<endl;
		cout<<linea11<<endl;
		cout<<linea12<<endl;
		cout<<linea13<<endl;
		cout<<linea14<<endl;
		cout<<linea15<<endl;
		cout<<linea16<<endl;
		cout<<linea17<<endl;
		cout<<linea18<<endl;
		
		if(lose){
			
			play=false;
		}
		
		if (kbhit() || !flag){
			
			if (flag){
				
				tecla=getch();	
			} 
			
			switch(tecla){
				
			//Animacion del egreso de monedas
			case 'E':
				
				if (monedas>0){
				
					if (contador==0){
						
						flag=false;
						linea13=linea13.replace(30,1,"*");
						
					} if (contador==1){
						
						linea13=linea13.replace(30,1," ");
						linea14=linea14.replace(30,1,"*");					
						
					} if (contador==2){
						
						linea14=linea14.replace(30,1," ");
						linea15=linea15.replace(30,1,"*");
						
					} if (contador==3){
						
						linea15=linea15.replace(30,1," ");
						linea16=linea16.replace(30,1,"*");
						
					} if (contador==4){
						
						linea16=linea16.replace(30,1," ");
						linea17=linea17.replace(30,1,"*");
						
					} if (contador==5){
						
						linea17=linea17.replace(30,1," ");
						monedas--;

						contador=-1;	
					}	
					
					contador++;
					break;				
				} 
				
				lose=true;
				break;
				
			//Animacion del ingreso de monedas	
			case 'I':
				
				
				if (contador==0){
					
					flag=false;
					linea1=linea1.replace(29,1,"*");
					
				} if (contador==1){
					
					linea1=linea1.replace(29,1," ");
					linea2=linea2.replace(29,1,"*");					
					
				} if (contador==2){
					
					linea2=linea2.replace(29,1," ");
					linea3=linea3.replace(29,1,"*");
					
				} if (contador==3){
					
					linea3=linea3.replace(29,1," ");
					linea4=linea4.replace(29,1,"*");
					
				} if (contador==4){
					
					linea4=linea4.replace(29,1,"-");
					
					if(monedas<9){
						
						monedas++;								
						
					} else {
						
						linea10=linea10.replace(16,13,"I AM FULL!!!!");
					}
					
					flag=true;
					contador=-1;
					
				}
				
				contador++;
				break;
			
			//Animacion de la palanca
			case 'P':
				
				if (monedas>0){
					
					n1=rand()%7+1;
					n2=rand()%7+1;
					n3=rand()%7+1;
					
					if (i==0){

						flag=false;
						
						linea2=linea2.replace(21,1,"o");
						linea2=linea2.replace(23,1,"o");
						
						linea10=linea10.replace(16,13,"             ");
						
					}
					
					if (i==29){
						
						monedas--;
						
						if(n1==n2 && n2==n3){
							
							int sumaMonedas=(n1+n2+n3);
							monedas+=sumaMonedas;
							
							linea2=linea2.replace(21,1,"$");
							linea2=linea2.replace(23,1,"$");
							
							linea10=linea10.replace(16,13,"YOU WIN!!!!!!");
							
							
						} else {
							
							linea2=linea2.replace(21,1,"X");
							linea2=linea2.replace(23,1,"X");
							
							if (monedas==0){
								
								lose=true;
								linea10=linea10.replace(16,13,"YOU LOSE!!!!!");
							}
						}
						
						flag=true;
						i=-1;					
					}
					
					i++;
				}
				
				break;

			}
		}
		
		///////////////////////Delay
		t1=clock();
		
		while (tempo<delay){
			
			t2=clock();
			
			tempo=(double(t2-t1)/CLOCKS_PER_SEC);
		}
		
		tempo=0.0;
		//////////////////////
		
	}
	
	return 0;
}

